import{G as C}from"./GLTFLoader-e6ad65de.js";import{D}from"./DRACOLoader-378133eb.js";import{C as x}from"./Capsule-b499a103.js";import{d as c,W as E,k as P,l as _,P as k,S as W,C as z,m as H,G as b,H as F,D as R,n as X}from"./three.module-9041595f.js";import{d as Y,o as A,c as G,a as V}from"./index-094517d4.js";const K={id:"container"},J=Y({__name:"Cannon",setup(B){let a,n,d,l,m;const s={};let t={geometry:new x(new c(0,.35,0),new c(0,1,0),.35),velocity:new c,direction:new c};const u=()=>{l=document.getElementById("container"),a=new E({antialias:!0}),a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.shadowMap.enabled=!0,a.shadowMap.type=P,a.toneMapping=_,l.appendChild(a.domElement),n=new k(75,window.innerWidth/window.innerHeight,.1,1e3),n.position.set(0,0,0),n.rotation.order="YXZ",d=new W,d.background=new z(8965358),d.fog=new H(8965358,0,50),d.add(new b(10));const o=new F(16777215,16777215,.5);o.position.set(2,1,1),d.add(o);const e=new R(16777215,.8);e.position.set(-5,25,-1),e.castShadow=!0,e.shadow.camera.near=.01,e.shadow.camera.far=500,e.shadow.camera.right=30,e.shadow.camera.left=-30,e.shadow.camera.top=30,e.shadow.camera.bottom=-30,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.radius=4,e.shadow.bias=-6e-5,d.add(e),m=new X,window.addEventListener("resize",y),g()},y=()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)},g=()=>{const o=new C,e=new D;e.setDecoderPath("./draco/"),e.setDecoderConfig({type:"js"}),e.preload(),o.setDRACOLoader(e),o.load("./model/1806.glb",r=>{d.add(r.scene),h()})},v=()=>{let o=!1,e=0,r=0;document.addEventListener("mousedown",i=>{o=!0,e=i.clientX,r=i.clientY},!1),document.addEventListener("mouseup",i=>{o=!1},!1),document.addEventListener("mousemove",i=>{if(o){const M=i.clientX-e,L=i.clientY-r;n.rotation.y-=M/500,n.rotation.x-=L/500,n.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,n.rotation.x)),e=i.clientX,r=i.clientY}},!1),document.addEventListener("keydown",i=>{s[i.code]=!0}),document.addEventListener("keyup",i=>{s[i.code]=!1})},f=o=>{const e=o*8;s.KeyW&&t.velocity.add(p().multiplyScalar(e)),s.KeyS&&t.velocity.add(p().multiplyScalar(-e)),s.KeyA&&t.velocity.add(w().multiplyScalar(-e)),s.KeyD&&t.velocity.add(w().multiplyScalar(e))},p=()=>(n.getWorldDirection(t.direction),t.direction.y=0,t.direction.normalize(),t.direction),w=()=>(n.getWorldDirection(t.direction),t.direction.y=0,t.direction.normalize(),t.direction.cross(n.up),t.direction),S=o=>{let e=Math.exp(-4*o)-1;t.velocity.addScaledVector(t.velocity,e);const r=t.velocity.clone().multiplyScalar(o);t.geometry.translate(r),n.position.copy(t.geometry.end)},h=()=>{const o=Math.min(.05,m.getDelta());f(o),S(o),a.render(d,n),requestAnimationFrame(h)};return A(()=>{u(),v()}),(o,e)=>(V(),G("div",K))}});export{J as default};
