import{d as W,O as H,z as O,Q as b,S as z,P as R,A,W as B,w as L,M as $,c as k,H as N,D as P}from"./three.module-c1ebb987.js";import{d as I,r as q,o as G,c as Q,a as U}from"./index-c4a4b524.js";const _=new W,V=new b,M=new W;class Z extends H{constructor(a=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=a,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(d){d.element instanceof Element&&d.element.parentNode!==null&&d.element.parentNode.removeChild(d.element)})})}copy(a,d){return super.copy(a,d),this.element=a.element.cloneNode(!0),this}}const m=new O,F=new O;class X{constructor(a={}){const d=this;let i,c,S,u;const o={camera:{fov:0,style:""},objects:new WeakMap},p=a.element!==void 0?a.element:document.createElement("div");p.style.overflow="hidden",this.domElement=p;const r=document.createElement("div");r.style.transformOrigin="0 0",r.style.pointerEvents="none",p.appendChild(r);const f=document.createElement("div");f.style.transformStyle="preserve-3d",r.appendChild(f),this.getSize=function(){return{width:i,height:c}},this.render=function(n,e){const l=e.projectionMatrix.elements[5]*u;o.camera.fov!==l&&(r.style.perspective=e.isPerspectiveCamera?l+"px":"",o.camera.fov=l),e.view&&e.view.enabled?(r.style.transform=`translate( ${-e.view.offsetX*(i/e.view.width)}px, ${-e.view.offsetY*(c/e.view.height)}px )`,r.style.transform+=`scale( ${e.view.fullWidth/e.view.width}, ${e.view.fullHeight/e.view.height} )`):r.style.transform="",n.matrixWorldAutoUpdate===!0&&n.updateMatrixWorld(),e.parent===null&&e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld();let C,w;e.isOrthographicCamera&&(C=-(e.right+e.left)/2,w=(e.top+e.bottom)/2);const h=e.view&&e.view.enabled?e.view.height/e.view.fullHeight:1,y=(e.isOrthographicCamera?`scale( ${h} )scale(`+l+")translate("+t(C)+"px,"+t(w)+"px)"+v(e.matrixWorldInverse):`scale( ${h} )translateZ(`+l+"px)"+v(e.matrixWorldInverse))+"translate("+S+"px,"+u+"px)";o.camera.style!==y&&(f.style.transform=y,o.camera.style=y),x(n,n,e)},this.setSize=function(n,e){i=n,c=e,S=i/2,u=c/2,p.style.width=n+"px",p.style.height=e+"px",r.style.width=n+"px",r.style.height=e+"px",f.style.width=n+"px",f.style.height=e+"px"};function t(n){return Math.abs(n)<1e-10?0:n}function v(n){const e=n.elements;return"matrix3d("+t(e[0])+","+t(-e[1])+","+t(e[2])+","+t(e[3])+","+t(e[4])+","+t(-e[5])+","+t(e[6])+","+t(e[7])+","+t(e[8])+","+t(-e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(-e[13])+","+t(e[14])+","+t(e[15])+")"}function s(n){const e=n.elements;return"translate(-50%,-50%)"+("matrix3d("+t(e[0])+","+t(e[1])+","+t(e[2])+","+t(e[3])+","+t(-e[4])+","+t(-e[5])+","+t(-e[6])+","+t(-e[7])+","+t(e[8])+","+t(e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(e[13])+","+t(e[14])+","+t(e[15])+")")}function x(n,e,l,C){if(n.isCSS3DObject){const w=n.visible===!0&&n.layers.test(l.layers)===!0;if(n.element.style.display=w===!0?"":"none",w===!0){n.onBeforeRender(d,e,l);let h;n.isCSS3DSprite?(m.copy(l.matrixWorldInverse),m.transpose(),n.rotation2D!==0&&m.multiply(F.makeRotationZ(n.rotation2D)),n.matrixWorld.decompose(_,V,M),m.setPosition(_),m.scale(M),m.elements[3]=0,m.elements[7]=0,m.elements[11]=0,m.elements[15]=1,h=s(m)):h=s(n.matrixWorld);const g=n.element,y=o.objects.get(n);if(y===void 0||y.style!==h){g.style.transform=h;const D={style:h};o.objects.set(n,D)}g.parentNode!==f&&f.appendChild(g),n.onAfterRender(d,e,l)}}for(let w=0,h=n.children.length;w<h;w++)x(n.children[w],e,l)}}}const K=I({__name:"CSS3dDemo",setup(E){const a=q(),d=()=>{const i=new z,c=new R(75,window.innerWidth/window.innerHeight,.1,1e3);c.position.z=10;const S=new A(100);i.add(S);const u=new B;u.setSize(window.innerWidth,window.innerHeight),a.value.appendChild(u.domElement);const o=new X;o.setSize(window.innerWidth,window.innerHeight),o.domElement.style.position="absolute",o.domElement.style.top="0px",a.value.appendChild(o.domElement);const p=document.createElement("div");p.textContent="Hello, CSS3DObject!",p.style.color="white";const r=new L(1,1,5),f=new $({color:65280}),t=new k(r,f);i.add(t);const v=new N(9290206,26253,.5);v.position.set(1,1,1),i.add(v);const s=new P(16777215,.8);s.position.set(-5,25,-1),s.castShadow=!0,s.shadow.camera.near=.01,s.shadow.camera.far=500,s.shadow.camera.right=30,s.shadow.camera.left=-30,s.shadow.camera.top=30,s.shadow.camera.bottom=-30,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.radius=4,s.shadow.bias=-6e-5,i.add(s);const x=new Z(p);x.scale.set(.1,.1,.1),x.position.set(0,0,-1),i.add(x);function n(){requestAnimationFrame(n),u.render(i,c),o.render(i,c)}n()};return G(()=>{d()}),(i,c)=>(U(),Q("div",{ref_key:"threeRef",ref:a},null,512))}});export{K as default};
