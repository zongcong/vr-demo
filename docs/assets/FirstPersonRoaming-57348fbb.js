import{a8 as h,S as R,C as B,P as C,A as E,d as i,au as G,M as H,c as L,a7 as P,G as F,W as I,n as V}from"./three.module-7764d4a2.js";import{d as z,r as T,o as q,c as N,b as l,a as U,p as X,e as Y,_ as j}from"./index-c59fbca8.js";const J=c=>(X("data-v-953babbe"),c=c(),Y(),c),O=J(()=>l("div",{class:"tips"},[l("p",null,"键盘 wsad 控制方向"),l("p",null,"键盘 v 切换第一第三人称")],-1)),Q=z({__name:"FirstPersonRoaming",setup(c){const w=T();let p=!1;const v=()=>{const _=h.degToRad(-15),y=h.degToRad(15),r=new R;r.background=new B(15790320);const d=new C(70,window.innerWidth/window.innerHeight,.1,1e3);d.position.set(0,1.6,-4.3),d.lookAt(0,1.6,0);const b=new E(5);r.add(b);const D=new V,a=new i(0,0,0),k=new G(.25,1.6,4,8),A=new H({color:65280}),n=new L(k,A);n.position.set(0,1.1,0);const s=new P;s.add(d),n.add(s),r.add(n);const M=new F(100,100);r.add(M);const f=new I({antialias:!0});f.setSize(window.innerWidth,window.innerHeight),w.value.appendChild(f.domElement);const o={W:!1,A:!1,S:!1,D:!1};let u=!0;document.addEventListener("keydown",e=>{e.code==="KeyW"&&(o.W=!0),e.code==="KeyA"&&(o.A=!0),e.code==="KeyS"&&(o.S=!0),e.code==="KeyD"&&(o.D=!0),e.code==="KeyV"&&(u?d.position.z=1:d.position.z=-4.3,u=!u)}),document.addEventListener("keyup",e=>{e.code==="KeyW"&&(o.W=!1),e.code==="KeyA"&&(o.A=!1),e.code==="KeyS"&&(o.S=!1),e.code==="KeyD"&&(o.D=!1)}),document.addEventListener("mousedown",()=>{p=!0}),document.addEventListener("mouseup",()=>{p=!1}),document.addEventListener("mousemove",e=>{p&&(n.rotation.y-=e.movementX/600,s.rotation.x-=e.movementY/600,s.rotation.x<_&&(s.rotation.x=_),s.rotation.x>y&&(s.rotation.x=y))});function g(){const e=D.getDelta();if(a.length()<5){if(o.W){const t=new i;n.getWorldDirection(t),a.add(t.multiplyScalar(12*e))}if(o.S){const t=new i;n.getWorldDirection(t),a.add(t.multiplyScalar(-12*e))}if(o.A){const t=new i;n.getWorldDirection(t);const m=new i(0,1,0).clone().cross(t);a.add(m.multiplyScalar(12*e))}if(o.D){const t=new i;n.getWorldDirection(t);const S=new i(0,1,0),m=t.clone().cross(S);a.add(m.multiplyScalar(12*e))}}a.addScaledVector(a,-.04);const K=a.clone().multiplyScalar(e);n.position.add(K),f.render(r,d),requestAnimationFrame(g)}g()};return q(()=>{v()}),(x,W)=>(U(),N("div",null,[l("div",{ref_key:"threeRef",ref:w},null,512),O]))}});const oe=j(Q,[["__scopeId","data-v-953babbe"]]);export{oe as default};
