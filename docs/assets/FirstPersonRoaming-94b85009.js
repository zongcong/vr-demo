import{I as h,S as R,C as B,P as C,A as E,d as i,J as G,M as H,c as L,K as P,G as I,W as F,n as V}from"./three.module-c1ebb987.js";import{d as z,r as T,o as q,c as J,b as l,a as N,p as U,e as X,_ as Y}from"./index-c4a4b524.js";const j=c=>(U("data-v-953babbe"),c=c(),X(),c),O=j(()=>l("div",{class:"tips"},[l("p",null,"键盘 wsad 控制方向"),l("p",null,"键盘 v 切换第一第三人称")],-1)),Q=z({__name:"FirstPersonRoaming",setup(c){const w=T();let p=!1;const v=()=>{const _=h.degToRad(-15),y=h.degToRad(15),r=new R;r.background=new B(15790320);const d=new C(70,window.innerWidth/window.innerHeight,.1,1e3);d.position.set(0,1.6,-4.3),d.lookAt(0,1.6,0);const b=new E(5);r.add(b);const D=new V,s=new i(0,0,0),k=new G(.25,1.6,4,8),A=new H({color:65280}),n=new L(k,A);n.position.set(0,1.1,0);const a=new P;a.add(d),n.add(a),r.add(n);const K=new I(100,100);r.add(K);const f=new F({antialias:!0});f.setSize(window.innerWidth,window.innerHeight),w.value.appendChild(f.domElement);const o={W:!1,A:!1,S:!1,D:!1};let u=!0;document.addEventListener("keydown",e=>{e.code==="KeyW"&&(o.W=!0),e.code==="KeyA"&&(o.A=!0),e.code==="KeyS"&&(o.S=!0),e.code==="KeyD"&&(o.D=!0),e.code==="KeyV"&&(u?d.position.z=1:d.position.z=-4.3,u=!u)}),document.addEventListener("keyup",e=>{e.code==="KeyW"&&(o.W=!1),e.code==="KeyA"&&(o.A=!1),e.code==="KeyS"&&(o.S=!1),e.code==="KeyD"&&(o.D=!1)}),document.addEventListener("mousedown",()=>{p=!0}),document.addEventListener("mouseup",()=>{p=!1}),document.addEventListener("mousemove",e=>{p&&(n.rotation.y-=e.movementX/600,a.rotation.x-=e.movementY/600,a.rotation.x<_&&(a.rotation.x=_),a.rotation.x>y&&(a.rotation.x=y))});function g(){const e=D.getDelta();if(s.length()<5){if(o.W){const t=new i;n.getWorldDirection(t),s.add(t.multiplyScalar(12*e))}if(o.S){const t=new i;n.getWorldDirection(t),s.add(t.multiplyScalar(-12*e))}if(o.A){const t=new i;n.getWorldDirection(t);const m=new i(0,1,0).clone().cross(t);s.add(m.multiplyScalar(12*e))}if(o.D){const t=new i;n.getWorldDirection(t);const S=new i(0,1,0),m=t.clone().cross(S);s.add(m.multiplyScalar(12*e))}}s.addScaledVector(s,-.04);const M=s.clone().multiplyScalar(e);n.position.add(M),f.render(r,d),requestAnimationFrame(g)}g()};return q(()=>{v()}),(x,W)=>(N(),J("div",null,[l("div",{ref_key:"threeRef",ref:w},null,512),O]))}});const oe=Y(Q,[["__scopeId","data-v-953babbe"]]);export{oe as default};
