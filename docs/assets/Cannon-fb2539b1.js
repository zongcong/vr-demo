import{C,G as D}from"./Capsule-5d402d02.js";import{D as x}from"./DRACOLoader-95884015.js";import{d as c,W as E,k as P,l as _,P as k,S as W,C as z,m as H,G as b,H as F,D as R,n as X}from"./three.module-6576df63.js";import{d as Y,o as A,c as G,a as V}from"./index-df782a4d.js";const K={id:"container"},Z=Y({__name:"Cannon",setup(B){let i,n,d,l,m;const s={};let t={geometry:new C(new c(0,.35,0),new c(0,1,0),.35),velocity:new c,direction:new c};const u=()=>{l=document.getElementById("container"),i=new E({antialias:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.shadowMap.enabled=!0,i.shadowMap.type=P,i.toneMapping=_,l.appendChild(i.domElement),n=new k(75,window.innerWidth/window.innerHeight,.1,1e3),n.position.set(0,0,0),n.rotation.order="YXZ",d=new W,d.background=new z(8965358),d.fog=new H(8965358,0,50),d.add(new b(10));const o=new F(16777215,16777215,.5);o.position.set(2,1,1),d.add(o);const e=new R(16777215,.8);e.position.set(-5,25,-1),e.castShadow=!0,e.shadow.camera.near=.01,e.shadow.camera.far=500,e.shadow.camera.right=30,e.shadow.camera.left=-30,e.shadow.camera.top=30,e.shadow.camera.bottom=-30,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.radius=4,e.shadow.bias=-6e-5,d.add(e),m=new X,window.addEventListener("resize",y),g()},y=()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)},g=()=>{const o=new D,e=new x;e.setDecoderPath("/draco/"),e.setDecoderConfig({type:"js"}),e.preload(),o.setDRACOLoader(e),o.load("/model/1806.glb",r=>{d.add(r.scene),h()})},v=()=>{let o=!1,e=0,r=0;document.addEventListener("mousedown",a=>{o=!0,e=a.clientX,r=a.clientY},!1),document.addEventListener("mouseup",a=>{o=!1},!1),document.addEventListener("mousemove",a=>{if(o){const M=a.clientX-e,L=a.clientY-r;n.rotation.y-=M/500,n.rotation.x-=L/500,n.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,n.rotation.x)),e=a.clientX,r=a.clientY}},!1),document.addEventListener("keydown",a=>{s[a.code]=!0}),document.addEventListener("keyup",a=>{s[a.code]=!1})},f=o=>{const e=o*8;s.KeyW&&t.velocity.add(w().multiplyScalar(e)),s.KeyS&&t.velocity.add(w().multiplyScalar(-e)),s.KeyA&&t.velocity.add(p().multiplyScalar(-e)),s.KeyD&&t.velocity.add(p().multiplyScalar(e))},w=()=>(n.getWorldDirection(t.direction),t.direction.y=0,t.direction.normalize(),t.direction),p=()=>(n.getWorldDirection(t.direction),t.direction.y=0,t.direction.normalize(),t.direction.cross(n.up),t.direction),S=o=>{let e=Math.exp(-4*o)-1;t.velocity.addScaledVector(t.velocity,e);const r=t.velocity.clone().multiplyScalar(o);t.geometry.translate(r),n.position.copy(t.geometry.end)},h=()=>{const o=Math.min(.05,m.getDelta());f(o),S(o),i.render(d,n),requestAnimationFrame(h)};return A(()=>{u(),v()}),(o,e)=>(V(),G("div",K))}});export{Z as default};
